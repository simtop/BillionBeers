apply plugin: 'com.android.dynamic-feature'
apply plugin: 'kotlin-android'
apply plugin: 'kotlin-parcelize'
apply plugin: 'kotlin-kapt'
apply plugin: 'dagger.hilt.android.plugin'
apply plugin: 'androidx.navigation.safeargs'

android {
    compileSdkVersion ApplicationConfig.compileSdk

    defaultConfig {
        minSdkVersion ApplicationConfig.minSdk
        targetSdkVersion ApplicationConfig.targetSdk
        versionCode ApplicationConfig.versionCode
        versionName ApplicationConfig.versionName

        testInstrumentationRunner "com.simtop.billionbeers.di.MockTestRunner"
    }

    defaultConfig {
        javaCompileOptions {
            annotationProcessorOptions {
                arguments["dagger.hilt.disableModulesHaveInstallInCheck"] = "true"
            }
        }
    }

    buildTypes {
        debug {
            testCoverageEnabled = true
        }
        release {

        }
    }

    kapt {
        correctErrorTypes true
    }

    // Always show the result of every unit test, even if it passes.
    testOptions.unitTests {
        includeAndroidResources = true

        all {
            testLogging {
                events 'passed', 'skipped', 'failed', 'standardOut', 'standardError'
            }
            maxHeapSize = "1024m"
        }
    }

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_11
        targetCompatibility JavaVersion.VERSION_11
    }
    kotlinOptions {
        jvmTarget = JavaVersion.VERSION_11.toString()
    }

    buildFeatures {
        viewBinding = true
    }

    kapt {
        generateStubs = true
    }

    //Solves some problems for compilation for UI Test
    packagingOptions {
        pickFirst  "**/attach_hotspot_windows.dll"
        exclude 'META-INF/AL2.0'
        exclude 'META-INF/LGPL2.1'
        exclude 'META-INF/licenses/ASM'
    }
}

dependencies {
    implementation fileTree(dir: "libs", include: ["*.jar"])
    implementation libs.kotlinStdlibJdk7
    implementation libs.coreKtx
    implementation libs.appcompat
    implementation libs.material
    implementation libs.constraintlayout

    implementation libs.glide
    implementation libs.lifecycleExtensions
    implementation libs.retrofit2ConverterGson
    implementation libs.okhttp3LoggingInterceptor
    implementation libs.roomCompiler
    implementation libs.roomKtx
    kapt libs.roomRuntime
    implementation libs.hiltAndroid
    kapt libs.hiltCompiler


    implementation libs.navigationFragmentKtx
    implementation libs.navigationUi
    implementation project(Modules.beer_domain)
    implementation project(Modules.presentation_utils)
    implementation project(Modules.core)

    implementation project(Modules.app)
    implementation libs.navigationDynamicFeaturesFragment



    testImplementation libs.mockkAndroid
    testImplementation libs.mockk
    testImplementation libs.coreTesting
    testImplementation libs.coroutinesTest
    testImplementation libs.kluentAndroid
    testImplementation libs.okhttp3Mockwebserver
    testImplementation libs.junit

    androidTestImplementation libs.hiltAndroidTesting
    kaptAndroidTest libs.hiltCompiler

    androidTestImplementation libs.junit
    androidTestImplementation libs.kotlinTestJunit
    androidTestImplementation libs.coroutinesTest
    androidTestImplementation libs.espressoCore
    androidTestImplementation libs.espressoContrib
    androidTestImplementation libs.espressoIdlingResource
    androidTestImplementation libs.testRunner
    androidTestImplementation libs.testRules
    androidTestImplementation libs.testCoreKtx
    androidTestImplementation libs.mockkAndroid
    androidTestImplementation libs.junitKtx
    androidTestImplementation libs.navigationTesting

    androidTestImplementation libs.coreTesting
    androidTestImplementation libs.fragmentTesting

    testImplementation libs.striktCore

    androidTestImplementation libs.striktCore
}